---
# file: host_vars/cmm-monasca-agent

# Monasca Agent user credentials
monasca_agent_user: cmm-agent
monasca_agent_password: "{{ cmm_monasca_agent_keystone_password }}"
monasca_agent_project: cmm

# Monasca Agent Configuration
monasca_agent_service: monitoring

# Variables for installing Python bindings for postgresql check
postgresql_version: 9.1
postgresql_dir: "{{ opt_dir }}/postgresql/{{ postgresql_version }}"
postgresql_bin_dir: "{{ postgresql_dir }}/bin"

# Additionally you can specify any number of name:value pairs in 'init_config'
# which will be available on every run in 'self.init_config'
monasca_checks:
  host_alive:
    init_config:
      ssh_port: 22
      ssh_timeout: 0.5
      ping_timeout: 1
    instances:
      - name: openstack
        host_name: "{{ keystone_host }}"
        alive_test: ssh
  elastic:
    init_config:
    instances:
      - url: "{{ elasticsearch_url }}"
  http_check:
    init_config:
    instances:
      - name: Kibana
        url: "{{ kibana_url }}"
        timeout: 1
        dimensions:
          component: kibana
          service: monitoring
      - name: Monasca Log Api
        url: "http://{{ monasca_host }}:{{ monasca_log_api_port }}/healthcheck"
        timeout: 1
        dimensions:
          component: monasca-log-api
          service: monitoring
  mysql:
    init_config:
    instances:
      - defaults_file: /root/.my.cnf
        server: "{{ monasca_host }}"
        user: "{{ mariadb_root_name }}"
  # this one's different because concatenated with default file
  process:
    init_config:
    instances:
      - name: monasca.log.agent
        search_string: ['monasca-log-agent']
        exact_match: False
        dimensions:
          component: monasca-log-agent
        service: logs-monitoring
      - name: monasca.log.transformer
        search_string: ['transformer.conf']
        exact_match: False
        dimensions:
          component: monasca-log-transformer
        service: logs-monitoring
      - name: monasca.log.persister
        search_string: ['persister.conf']
        exact_match: False
        dimensions:
          component: monasca-log-persister
        service: logs-monitoring
